{"ast":null,"code":"import utils from '../utils';\nimport template from 'lodash.template';\nimport isEqual from 'lodash.isequal';\nlet fs = require('fs'); // substack/brfs#39\nlet instructionsTemplate = template(fs.readFileSync(__dirname + '/../templates/instructions.html', 'utf8'));\nlet errorTemplate = template(fs.readFileSync(__dirname + '/../templates/error.html', 'utf8'));\n\n/**\n * Summary/Instructions controller\n *\n * @param {HTMLElement} el Summary parent container\n * @param {Object} store A redux store\n * @param {Object} actions Actions an element can dispatch\n * @param {Object} map The mapboxgl instance\n * @private\n */\nexport default class Instructions {\n  constructor(el, store, actions, map) {\n    this.container = el;\n    this.actions = actions;\n    this.store = store;\n    this._map = map;\n    this.directions = {};\n    this.render();\n  }\n  render() {\n    this.store.subscribe(() => {\n      const {\n        hoverMarker,\n        setRouteIndex\n      } = this.actions;\n      const {\n        routeIndex,\n        unit,\n        directions,\n        error,\n        compile\n      } = this.store.getState();\n      const shouldRender = !isEqual(directions[routeIndex], this.directions);\n      if (error) {\n        this.container.innerHTML = errorTemplate({\n          error\n        });\n        return;\n      }\n      if (directions.length && shouldRender) {\n        const direction = this.directions = directions[routeIndex];\n        if (compile) {\n          direction.legs.forEach(function (leg) {\n            leg.steps.forEach(function (step) {\n              step.maneuver.instruction = compile('en', step);\n            });\n          });\n        }\n        this.container.innerHTML = instructionsTemplate({\n          routeIndex,\n          routes: directions.length,\n          steps: direction.legs[0].steps,\n          // Todo: Respect all legs,\n          format: utils.format[unit],\n          duration: utils.format[unit](direction.distance),\n          distance: utils.format.duration(direction.duration)\n        });\n        const steps = this.container.querySelectorAll('.mapbox-directions-step');\n        Array.prototype.forEach.call(steps, el => {\n          const lng = el.getAttribute('data-lng');\n          const lat = el.getAttribute('data-lat');\n          el.addEventListener('mouseover', () => {\n            hoverMarker([lng, lat]);\n          });\n          el.addEventListener('mouseout', () => {\n            hoverMarker(null);\n          });\n          el.addEventListener('click', () => {\n            this._map.flyTo({\n              center: [lng, lat],\n              zoom: 16\n            });\n          });\n        });\n        const routes = this.container.querySelectorAll('input[type=\"radio\"]');\n        Array.prototype.forEach.call(routes, el => {\n          el.addEventListener('change', e => {\n            setRouteIndex(parseInt(e.target.id, 10));\n          });\n        });\n      } else if (this.container.innerHTML && shouldRender) {\n        this.container.innerHTML = '';\n      }\n    });\n  }\n}","map":{"version":3,"names":["utils","template","isEqual","fs","require","instructionsTemplate","readFileSync","__dirname","errorTemplate","Instructions","constructor","el","store","actions","map","container","_map","directions","render","subscribe","hoverMarker","setRouteIndex","routeIndex","unit","error","compile","getState","shouldRender","innerHTML","length","direction","legs","forEach","leg","steps","step","maneuver","instruction","routes","format","duration","distance","querySelectorAll","Array","prototype","call","lng","getAttribute","lat","addEventListener","flyTo","center","zoom","e","parseInt","target","id"],"sources":["/Users/bhavyatanwar/Desktop/ev-charging/node_modules/mapbox-gl-direction-location/src/controls/instructions.js"],"sourcesContent":["import utils from '../utils';\nimport template from 'lodash.template';\nimport isEqual from 'lodash.isequal';\n\nlet fs = require('fs'); // substack/brfs#39\nlet instructionsTemplate = template(fs.readFileSync(__dirname + '/../templates/instructions.html', 'utf8'));\nlet errorTemplate = template(fs.readFileSync(__dirname + '/../templates/error.html', 'utf8'));\n\n/**\n * Summary/Instructions controller\n *\n * @param {HTMLElement} el Summary parent container\n * @param {Object} store A redux store\n * @param {Object} actions Actions an element can dispatch\n * @param {Object} map The mapboxgl instance\n * @private\n */\nexport default class Instructions {\n  constructor(el, store, actions, map) {\n    this.container = el;\n    this.actions = actions;\n    this.store = store;\n    this._map = map;\n    this.directions = {};\n    this.render();\n  }\n\n  render() {\n    this.store.subscribe(() => {\n      const { hoverMarker, setRouteIndex } = this.actions;\n      const { routeIndex, unit, directions, error, compile } = this.store.getState();\n      const shouldRender = !isEqual(directions[routeIndex], this.directions);\n\n      if (error) {\n        this.container.innerHTML = errorTemplate({ error });\n        return;\n      }\n\n      if (directions.length && shouldRender) {\n        const direction = this.directions = directions[routeIndex];\n\n        if (compile) {\n          direction.legs.forEach(function(leg) {\n            leg.steps.forEach(function(step) {\n              step.maneuver.instruction = compile('en', step);\n            });\n          });\n        }\n\n        this.container.innerHTML = instructionsTemplate({\n          routeIndex,\n          routes: directions.length,\n          steps: direction.legs[0].steps, // Todo: Respect all legs,\n          format: utils.format[unit],\n          duration: utils.format[unit](direction.distance),\n          distance: utils.format.duration(direction.duration)\n        });\n\n        const steps = this.container.querySelectorAll('.mapbox-directions-step');\n\n        Array.prototype.forEach.call(steps, (el) => {\n          const lng = el.getAttribute('data-lng');\n          const lat = el.getAttribute('data-lat');\n\n          el.addEventListener('mouseover', () => {\n            hoverMarker([lng, lat]);\n          });\n\n          el.addEventListener('mouseout', () => {\n            hoverMarker(null);\n          });\n\n          el.addEventListener('click', () => {\n            this._map.flyTo({\n              center: [lng, lat],\n              zoom: 16\n            });\n          });\n        });\n\n        const routes = this.container.querySelectorAll('input[type=\"radio\"]');\n        Array.prototype.forEach.call(routes, (el) => {\n          el.addEventListener('change', (e) => { setRouteIndex(parseInt(e.target.id, 10)); });\n        });\n      } else if (this.container.innerHTML && shouldRender) {\n        this.container.innerHTML = '';\n      }\n    });\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}